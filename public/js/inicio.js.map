{"version":3,"file":"inicio.js","mappings":";;UAAA;UACA;;;;;WCDA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,EAAE,yBAAyB,EAAE,EAAE,EAAE,EAAE,EAAE;AAC7D;AACA,cAAc;AACd,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,eAAe;AAC/D;AACA;AACA,4CAA4C,2BAA2B;AACvE,mEAAmE,iBAAiB;AACpF,0BAA0B,iBAAiB;AAC3C,sCAAsC,wBAAwB;AAC9D,4BAA4B,aAAa;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC","sources":["webpack://my-webpack-project/webpack/bootstrap","webpack://my-webpack-project/webpack/runtime/make namespace object","webpack://my-webpack-project/./src/js/inicio.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","(async function () {\r\n  let coord = {\r\n    lat: -31.745892337795638,\r\n    lng: -60.53923534164746,\r\n  };\r\n\r\n  const mapa = L.map(\"mapa-inicio\").setView(coord, 13);\r\n\r\n  L.tileLayer(\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\", {\r\n    attribution:\r\n      '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\r\n  }).addTo(mapa);\r\n\r\n  //este grupo serÃ¡ una capa por encima del mapa, para poder modificarla mas adelante\r\n  //sin tener que modificar el mapa completo\r\n  const markersGroup = new L.FeatureGroup().addTo(mapa);\r\n\r\n  const propiedades = await consultarApiPropiedades();\r\n\r\n  mostrarPinesPropiedades(propiedades);\r\n\r\n  const categoriasSelect = document.querySelector(\"#categorias\");\r\n  const preciosSelect = document.querySelector(\"#precios\");\r\n  const contenedorControlesFiltro = categoriasSelect.parentNode.parentNode;\r\n\r\n  const filtros = {\r\n    categoriaId: \"\",\r\n    precioId: \"\",\r\n  };\r\n\r\n  categoriasSelect.addEventListener(\"change\", (event) => {\r\n    filtros.categoriaId = +event.target.value;\r\n    filtrarYMostrarPropiedades();\r\n  });\r\n\r\n  preciosSelect.addEventListener(\"change\", (event) => {\r\n    filtros.precioId = +event.target.value;\r\n    filtrarYMostrarPropiedades();\r\n  });\r\n\r\n  function consultarApiPropiedades() {\r\n    const urlPropiedades = \"/api/propiedades\";\r\n\r\n    return fetch(urlPropiedades)\r\n      .then((respuesta) => {\r\n        return respuesta.json();\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n  }\r\n    \r\n  function mostrarPinesPropiedades(propiedades) {\r\n    if (propiedades.length === 0) {\r\n      mostrarMensajeNoHayPropiedades();\r\n      return;\r\n    }\r\n\r\n    eliminarMensajeNoHayPropiedades();\r\n\r\n    //creamos una instancia de limites vacia\r\n    const bounds = new L.LatLngBounds();\r\n\r\n    markersGroup.clearLayers();\r\n\r\n    propiedades.forEach((propiedad, index) => {\r\n      const [lat, lng] = propiedad.coordenadas.split(\",\");\r\n\r\n      const marker = new L.marker([lat, lng], { autoPan: true }).addTo(mapa);\r\n\r\n      const textForMarker = `\r\n      <p class=\"text-green-400 font-bold\">${propiedad.categoria.nombre}</p >\r\n      <h3 class=\"text-lg text-zinc-800 my-0 font-bold px=0 py=0\">${propiedad.titulo}</h3>\r\n      <img src=\"uploads/${propiedad.imagen}\", alt=\"imagen_propiedad\" class=\" w-full block mb-2 mt-2\")/>\r\n      <p class=\" text-zinc-500 m-0\">${propiedad.precio.nombre}</p >\r\n      <a href=\"/propiedad/${propiedad.id}\" class=\" bg-green-400 block text-center text-zinc-800 font-bold rounded px-2 py-1 cursor-pointer\">Ver propiedad</a>`;\r\n\r\n      markersGroup.addLayer(marker);\r\n      //vamos agregando los limites para crear un area geografica en el mapa\r\n      bounds.extend([lat, lng]);\r\n\r\n      if (index === 0) {\r\n        marker.bindPopup(textForMarker).openPopup();\r\n      } else {\r\n        marker.bindPopup(textForMarker);\r\n      }\r\n    });\r\n\r\n    //ajusta el zoom a esa area\r\n    mapa.fitBounds(bounds);\r\n  }\r\n\r\n  function filtrarYMostrarPropiedades() {\r\n    const propiedadesFiltradas = propiedades\r\n      .filter(filtroCategoria)\r\n      .filter(filtroPrecio);\r\n\r\n    mostrarPinesPropiedades(propiedadesFiltradas);\r\n  }\r\n\r\n  function filtroCategoria(propiedad) {\r\n    return (\r\n      !filtros.categoriaId || propiedad.categoria.id === filtros.categoriaId\r\n    );\r\n  }\r\n\r\n  function filtroPrecio(propiedad) {\r\n    return !filtros.precioId || propiedad.precio.id === filtros.precioId;\r\n  }\r\n\r\n  function mostrarMensajeNoHayPropiedades() {\r\n    eliminarMensajeNoHayPropiedades();\r\n    const elementoMensaje = document.createElement(\"P\");\r\n    elementoMensaje.classList.add(\r\n      \"text-red-500\",\r\n      \"text-md\",\r\n      \"font-bold\",\r\n      \"flex-1\"\r\n    );\r\n    elementoMensaje.id = \"mensajeNoHayResultados\";\r\n    elementoMensaje.textContent = \"No hay Resultados !\";\r\n    contenedorControlesFiltro.appendChild(elementoMensaje);\r\n  }\r\n\r\n  function eliminarMensajeNoHayPropiedades() {\r\n    const mensajeAnterior = document.querySelector(\"#mensajeNoHayResultados\");\r\n    if (mensajeAnterior) {\r\n      mensajeAnterior.remove();\r\n    }\r\n    return;\r\n  }\r\n})();\r\n"],"names":[],"sourceRoot":""}